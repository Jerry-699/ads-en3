<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
  <title>Lifeinvader Ads — EN-03 Policy Accurate</title>

  <!-- Fonts & Icons -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700,900|Roboto+Slab:400,700">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet"/>
  <script src="https://kit.fontawesome.com/42d5adcbca.js" crossorigin="anonymous"></script>

  <!-- Material Kit CSS -->
  <link id="pagestyle" href="https://cdn.jsdelivr.net/gh/creativetimofficial/material-kit@3.0.4/assets/css/material-kit.css" rel="stylesheet"/>

  <style>
    :root{
      --ok:#10b981; --warn:#d97706; --bad:#e11d48;
    }
    .note{font-size:.9rem;color:#64748b}
    .chip{display:inline-block;padding:.25rem .5rem;border-radius:999px;background:#f1f5f9;margin:.15rem 0;font-size:.8rem}
    .chip.ok{background:rgba(16,185,129,.12);color:var(--ok)}
    .chip.warn{background:rgba(217,119,6,.12);color:var(--warn)}
    .chip.bad{background:rgba(225,29,72,.12);color:var(--bad)}
    .policy-box{border-left:4px solid #3b82f6;background:#eff6ff;padding:.5rem .75rem;border-radius:.5rem}
    .error-box{border-left:4px solid var(--bad);background:rgba(225,29,72,.08);padding:.5rem .75rem;border-radius:.5rem}
    .btn-clear{white-space:nowrap}
    .w-100p{width:100%}
    .opacity-4{opacity:.35}
    .form-control[readonly]{background:#f8fafc}
    .small{font-size:.9rem}
  </style>
</head>
<body class="index-page bg-gray-200">

  <header class="header-2">
    <div class="page-header min-vh-25" style="background-image:url('https://images.unsplash.com/photo-1496307042754-b4aa456c4a2d?q=80&w=1600&auto=format&fit=crop'); background-position:center;">
      <span class="mask bg-gradient-primary opacity-4"></span>
      <div class="container">
        <div class="row">
          <div class="col-lg-8 mx-auto text-center">
            <h1 class="text-white pt-3">Lifeinvader Ads — EN-03</h1>
            <p class="lead text-white">Policy-accurate ad builder (Real Estate • Auto • Other • Business • Dating • Work)</p>
          </div>
        </div>
      </div>
    </div>
  </header>

  <main class="card card-body blur shadow-blur mx-3 mx-md-4 mt-n6">
    <section class="pt-3 pb-4">
      <div class="container">
        <div class="row">
          <div class="col-lg-10 mx-auto">

            <div class="policy-box mb-3 small">
              This builder enforces: opener words (Buying/Selling/Trading/Selling or trading/Renting out), Price/Budget/Rent with <b>Negotiable</b> default, dot thousand separators, <b>№</b> for numbered properties, Real Estate feature order, apartments not insured, vehicles in quotes with upgrade order (configuration → visual upgrades → luminous wheels → insurance → turbo kit → drift kit), blacklisted terms rejection, Beach Market rule (no “Negotiable” line), license plate 3–7 chars, etc.
            </div>

            <ul class="nav nav-pills nav-fill p-1 bg-gray-100" role="tablist">
              <li class="nav-item">
                <a class="nav-link active" data-bs-toggle="tab" href="#tab-real" role="tab">
                  <span class="material-icons align-middle mb-1">location_city</span> Real Estate
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" data-bs-toggle="tab" href="#tab-auto" role="tab">
                  <span class="material-icons align-middle mb-1">directions_car</span> Auto
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" data-bs-toggle="tab" href="#tab-other" role="tab">
                  <span class="material-icons align-middle mb-1">all_inclusive</span> Other
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" data-bs-toggle="tab" href="#tab-biz" role="tab">
                  <span class="material-icons align-middle mb-1">store</span> Business
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" data-bs-toggle="tab" href="#tab-dating" role="tab">
                  <span class="material-icons align-middle mb-1">favorite</span> Dating
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" data-bs-toggle="tab" href="#tab-work" role="tab">
                  <span class="material-icons align-middle mb-1">engineering</span> Work
                </a>
              </li>
            </ul>

            <div class="tab-content pt-3">
              <!-- REAL ESTATE -->
              <div class="tab-pane fade show active" id="tab-real" role="tabpanel">
                <form id="form-real" onsubmit="return false;">
                  <div class="row g-3">
                    <div class="col-6 col-md-3">
                      <h6>Action</h6>
                      <div class="form-check ps-0">
                        <input class="form-check-input" type="radio" name="reAction" id="reSell" value="Selling" checked>
                        <label for="reSell" class="custom-control-label">Selling</label>
                      </div>
                      <div class="form-check ps-0">
                        <input class="form-check-input" type="radio" name="reAction" id="reBuy" value="Buying">
                        <label for="reBuy" class="custom-control-label">Buying</label>
                      </div>
                      <div class="form-check ps-0">
                        <input class="form-check-input" type="radio" name="reAction" id="reRent" value="Renting out">
                        <label for="reRent" class="custom-control-label">Renting out</label>
                      </div>
                    </div>

                    <div class="col-6 col-md-3">
                      <h6>Property</h6>
                      <select id="reType" class="form-control">
                        <option>house</option>
                        <option>apartment</option>
                        <option>penthouse</option>
                        <option>mansion</option>
                      </select>
                      <div class="note mt-1">If number empty, we’ll add “a/an”. If provided → <b>№</b> format.</div>
                    </div>

                    <div class="col-6 col-md-3">
                      <h6>Number (optional)</h6>
                      <input id="reNum" class="form-control" type="number" placeholder="e.g., 758">
                    </div>

                    <div class="col-6 col-md-3">
                      <h6>Location (optional)</h6>
                      <input id="reLoc" class="form-control" placeholder="e.g., Vinewood Hills">
                    </div>
                  </div>

                  <div class="row g-3 mt-1">
                    <div class="col-12 col-md-6">
                      <h6>Features</h6>
                      <div class="row">
                        <div class="col-6">
                          <div class="form-check ps-0">
                            <input class="form-check-input" type="checkbox" id="reGarden">
                            <label for="reGarden" class="custom-control-label">Garden</label>
                          </div>
                          <div class="form-check ps-0">
                            <input class="form-check-input" type="checkbox" id="reCustom">
                            <label for="reCustom" class="custom-control-label">Custom interior</label>
                          </div>
                          <div class="form-check ps-0">
                            <input class="form-check-input" type="checkbox" id="reIns">
                            <label for="reIns" class="custom-control-label">Insurance</label>
                          </div>
                          <div class="form-check ps-0">
                            <input class="form-check-input" type="checkbox" id="reHeli">
                            <label for="reHeli" class="custom-control-label">Helipad</label>
                          </div>
                        </div>
                        <div class="col-6">
                          <div class="mb-2">
                            <label class="small">Garage (g.s.)</label>
                            <select id="reGS" class="form-control">
                              <option value="">—</option>
                              <option>2 g.s.</option>
                              <option>5 g.s.</option>
                              <option>9 g.s.</option>
                              <option>25 g.s.</option>
                            </select>
                          </div>
                          <div class="mb-2">
                            <label class="small">Warehouses (w.h.)</label>
                            <input id="reWH" class="form-control" type="number" min="1" placeholder="e.g., 3">
                          </div>
                          <div>
                            <label class="small">Other</label>
                            <input id="reOther" class="form-control" placeholder="swimming pool, long driveway, nice views">
                          </div>
                        </div>
                      </div>
                    </div>

                    <div class="col-12 col-md-6">
                      <h6 class="d-flex align-items-center justify-content-between">
                        <span id="reMoneyLabel">Price</span>
                        <button type="button" class="btn btn-sm bg-gradient-dark btn-clear" onclick="clearFields(['reAmt'])">Clear</button>
                      </h6>
                      <input id="reAmt" class="form-control" placeholder="e.g., 1.7k, 8m, Negotiable, 650 each">
                      <div class="note mt-1">We’ll normalize: <b>$1k→$1.000</b>, <b>$1.7k each→$1.700 each</b>, <b>$3m→$3 Million</b>, add <b>$</b>, dot thousands, and sentence period if needed.</div>
                    </div>
                  </div>

                  <div class="row g-3 mt-3">
                    <div class="col-12 d-flex gap-2">
                      <button class="btn bg-gradient-primary" onclick="generateReal()">Generate</button>
                      <button class="btn bg-gradient-secondary" onclick="clearForm('form-real')">Clear</button>
                    </div>
                  </div>
                </form>
              </div>

              <!-- AUTO -->
              <div class="tab-pane fade" id="tab-auto" role="tabpanel">
                <form id="form-auto" onsubmit="return false;">
                  <div class="row g-3">
                    <div class="col-6 col-md-3">
                      <h6>Action</h6>
                      <div class="form-check ps-0">
                        <input class="form-check-input" type="radio" name="auAction" id="auSell" value="Selling" checked>
                        <label for="auSell" class="custom-control-label">Selling</label>
                      </div>
                      <div class="form-check ps-0">
                        <input class="form-check-input" type="radio" name="auAction" id="auBuy" value="Buying">
                        <label for="auBuy" class="custom-control-label">Buying</label>
                      </div>
                      <div class="form-check ps-0">
                        <input class="form-check-input" type="radio" name="auAction" id="auTrade" value="Trading">
                        <label for="auTrade" class="custom-control-label">Trading</label>
                      </div>
                      <div class="form-check ps-0">
                        <input class="form-check-input" type="radio" name="auAction" id="auSellTrade" value="Selling or trading">
                        <label for="auSellTrade" class="custom-control-label">Selling or trading</label>
                      </div>
                    </div>

                    <div class="col-12 col-md-5">
                      <h6>Vehicle (brand & model)</h6>
                      <input id="auName" class="form-control" placeholder='e.g., Ubermacht M5 (E34)'>
                      <div class="note mt-1">We’ll quote it automatically → <b>"Ubermacht M5 (E34)"</b></div>
                    </div>

                    <div class="col-12 col-md-4">
                      <h6 class="d-flex align-items-center justify-content-between">
                        <span id="auMoneyLabel">Price</span>
                        <button type="button" class="btn btn-sm bg-gradient-dark btn-clear" onclick="clearFields(['auAmt'])">Clear</button>
                      </h6>
                      <input id="auAmt" class="form-control" placeholder="e.g., Negotiable, 8m, 1.5k">
                    </div>
                  </div>

                  <div class="row g-3 mt-1">
                    <div class="col-12">
                      <h6>Upgrades</h6>
                      <div class="row">
                        <div class="col-12 col-lg-6">
                          <label class="small">Configuration</label>
                          <select id="auCfg" class="form-control">
                            <option value="">None</option>
                            <option>with partial configuration</option>
                            <option>with full configuration</option>
                          </select>
                        </div>
                        <div class="col-12 col-lg-6 d-flex flex-wrap align-items-center gap-3 mt-2">
                          <div class="form-check ps-0"><input class="form-check-input" type="checkbox" id="auVisual"><label for="auVisual" class="custom-control-label">visual upgrades</label></div>
                          <div class="form-check ps-0"><input class="form-check-input" type="checkbox" id="auLumi"><label for="auLumi" class="custom-control-label">luminous wheels</label></div>
                          <div class="form-check ps-0"><input class="form-check-input" type="checkbox" id="auIns"><label for="auIns" class="custom-control-label">insurance</label></div>
                          <div class="form-check ps-0"><input class="form-check-input" type="checkbox" id="auTurbo"><label for="auTurbo" class="custom-control-label">turbo kit</label></div>
                          <div class="form-check ps-0"><input class="form-check-input" type="checkbox" id="auDrift"><label for="auDrift" class="custom-control-label">drift kit</label></div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="row g-3 mt-3">
                    <div class="col-12 d-flex gap-2">
                      <button class="btn bg-gradient-primary" onclick="generateAuto()">Generate</button>
                      <button class="btn bg-gradient-secondary" onclick="clearForm('form-auto')">Clear</button>
                    </div>
                  </div>
                </form>
              </div>

              <!-- OTHER -->
              <div class="tab-pane fade" id="tab-other" role="tabpanel">
                <form id="form-other" onsubmit="return false;">
                  <div class="row g-3">
                    <div class="col-12 col-md-3">
                      <h6>Action</h6>
                      <div class="form-check ps-0">
                        <input class="form-check-input" type="radio" name="otAction" id="otSell" value="Selling" checked>
                        <label for="otSell" class="custom-control-label">Selling</label>
                      </div>
                      <div class="form-check ps-0">
                        <input class="form-check-input" type="radio" name="otAction" id="otBuy" value="Buying">
                        <label for="otBuy" class="custom-control-label">Buying</label>
                      </div>
                    </div>

                    <div class="col-12 col-md-5">
                      <h6>Items (max 3)</h6>
                      <input id="ot1" class="form-control mb-2" placeholder="First item…" required>
                      <input id="ot2" class="form-control mb-2" placeholder="Second item (optional)…">
                      <input id="ot3" class="form-control" placeholder="Third item (optional)…">
                      <div class="note mt-1">Example: <b>luminous wheels of type 4</b>, <b>tokens</b>, <b>video cards</b>, <b>license plate (1ABC234)</b>, etc.</div>
                    </div>

                    <div class="col-12 col-md-4">
                      <h6 class="d-flex align-items-center justify-content-between">
                        <span id="otMoneyLabel">Price</span>
                        <button type="button" class="btn btn-sm bg-gradient-dark btn-clear" onclick="clearFields(['otAmt'])">Clear</button>
                      </h6>
                      <input id="otAmt" class="form-control" placeholder="e.g., Negotiable, 650 each, 3m">
                      <div class="note mt-1">We’ll normalize numbers and add period if needed.</div>
                    </div>
                  </div>

                  <div class="row g-3 mt-1">
                    <div class="col-12">
                      <h6>Event/Service (optional)</h6>
                      <select id="otEvent" class="form-control">
                        <option value="">—</option>
                        <option>Looking for a party.</option>
                        <option>Party at the beach.</option>
                        <option>Party at the yacht.</option>
                        <option>Party at Bahama Mamas Bar.</option>
                        <option>Party at Tequi-la-la Bar.</option>
                        <option>Party at Cayo Perico.</option>
                        <option>Party at house №</option>
                        <option>Pool party at house №</option>
                        <option>Looking for an alliance.</option>
                        <option>Looking for a lawyer.</option>
                        <option>Looking for a personal driver.</option>
                        <option>Looking for a professional dancer.</option>
                        <option>Looking for a professional singer.</option>
                        <option>Looking for a DJ.</option>
                        <option>Looking to play poker.</option>
                        <option>Looking to play dice.</option>
                      </select>
                    </div>
                  </div>

                  <div class="row g-3 mt-3">
                    <div class="col-12 d-flex gap-2">
                      <button class="btn bg-gradient-primary" onclick="generateOther()">Generate</button>
                      <button class="btn bg-gradient-secondary" onclick="clearForm('form-other')">Clear</button>
                    </div>
                  </div>
                </form>
              </div>

              <!-- BUSINESS -->
              <div class="tab-pane fade" id="tab-biz" role="tabpanel">
                <form id="form-biz" onsubmit="return false;">
                  <div class="row g-3">
                    <div class="col-12 col-md-3">
                      <h6>Action</h6>
                      <div class="form-check ps-0">
                        <input class="form-check-input" type="radio" name="bzAction" id="bzSell" value="Selling" checked>
                        <label for="bzSell" class="custom-control-label">Selling</label>
                      </div>
                      <div class="form-check ps-0">
                        <input class="form-check-input" type="radio" name="bzAction" id="bzBuy" value="Buying">
                        <label for="bzBuy" class="custom-control-label">Buying</label>
                      </div>
                    </div>
                    <div class="col-12 col-md-5">
                      <h6>Business</h6>
                      <select id="bzName" class="form-control">
                        <option>Ammunition Store</option><option>Bar</option><option>Car wash</option>
                        <option>Chip tuning</option><option>Clothing shop</option><option>Cowshed</option>
                        <option>Electric station</option><option>Farm</option><option>Flower shop</option>
                        <option>Freight train</option><option>Gas station</option><option>Hair salon</option>
                        <option>Jewelry store</option><option>Oil Well</option><option>Parking</option>
                        <option>Plantation</option><option>Car sharing</option><option>State object</option>
                        <option>Service station</option><option>24/7 Store</option><option>Tattoo studio</option>
                        <option>Taxi company</option><option>ATM</option><option>Juice shop</option>
                        <option>Burger shop</option><option>Warehouse</option>
                      </select>
                      <div class="note mt-1">If client doesn’t give a number, we’ll use the word <b>business</b>.</div>
                    </div>
                    <div class="col-6 col-md-2">
                      <h6>Number (optional)</h6>
                      <input id="bzNum" class="form-control" type="number" placeholder="e.g., 44">
                    </div>
                    <div class="col-6 col-md-2">
                      <h6 class="d-flex align-items-center justify-content-between">
                        <span id="bzMoneyLabel">Price</span>
                      </h6>
                      <input id="bzAmt" class="form-control" placeholder="e.g., Negotiable, 100m">
                      <div class="note mt-1">If over $300 Million, we auto-set Negotiable.</div>
                    </div>
                  </div>

                  <div class="row g-3 mt-3">
                    <div class="col-12 d-flex gap-2">
                      <button class="btn bg-gradient-primary" onclick="generateBiz()">Generate</button>
                      <button class="btn bg-gradient-secondary" onclick="clearForm('form-biz')">Clear</button>
                    </div>
                  </div>
                </form>
              </div>

              <!-- DATING -->
              <div class="tab-pane fade" id="tab-dating" role="tabpanel">
                <form id="form-dating" onsubmit="return false;">
                  <div class="row g-3">
                    <div class="col-12 col-md-6">
                      <h6>Looking for</h6>
                      <select id="dtType" class="form-control">
                        <option>Looking for a family.</option>
                        <option>Looking for family members.</option>
                        <option>Looking for a date.</option>
                        <option>Looking for a wife.</option>
                        <option>Looking for a husband.</option>
                        <option>Looking for a valentine.</option>
                        <option>Looking for a friend.</option>
                        <option>Looking for friends.</option>
                        <option>Looking for a boyfriend.</option>
                        <option>Looking for boyfriends.</option>
                        <option>Looking for a girlfriend.</option>
                        <option>Looking for girlfriends.</option>
                        <option>Looking for Casino poker players.</option>
                      </select>
                    </div>
                    <div class="col-12 col-md-6">
                      <h6>Specific person (optional)</h6>
                      <input id="dtName" class="form-control" placeholder="Firstname Lastname">
                      <div class="note mt-1">If you provide a person, we enforce capitalized First + Last name. No Price/Budget allowed.</div>
                    </div>
                  </div>

                  <div class="row g-3 mt-3">
                    <div class="col-12 d-flex gap-2">
                      <button class="btn bg-gradient-primary" onclick="generateDating()">Generate</button>
                      <button class="btn bg-gradient-secondary" onclick="clearForm('form-dating')">Clear</button>
                    </div>
                  </div>
                </form>
              </div>

              <!-- WORK -->
              <div class="tab-pane fade" id="tab-work" role="tabpanel">
                <form id="form-work" onsubmit="return false;">
                  <div class="row g-3">
                    <div class="col-12 col-md-3">
                      <h6>Type</h6>
                      <div class="form-check ps-0">
                        <input class="form-check-input" type="radio" name="wkType" id="wkHiring" value="Hiring" checked>
                        <label for="wkHiring" class="custom-control-label">Hiring</label>
                      </div>
                      <div class="form-check ps-0">
                        <input class="form-check-input" type="radio" name="wkType" id="wkLooking" value="Looking for work">
                        <label for="wkLooking" class="custom-control-label">Looking for work</label>
                      </div>
                    </div>
                    <div class="col-12 col-md-5">
                      <h6>Role</h6>
                      <select id="wkRole" class="form-control">
                        <option value="">Select role</option>
                        <option>locksmith</option><option>electrician</option><option>gardener</option><option>surveyor</option><option>driver</option>
                        <option>trucker</option><option>Lawyer</option><option>DJ</option><option>photographer</option><option>bodyguard</option>
                        <option>professional dancer</option><option>personal driver</option><option>an assistant</option><option>professional singer</option>
                        <option>workers for solar panel plantations</option>
                      </select>
                    </div>
                    <div class="col-12 col-md-4">
                      <h6>Salary (optional)</h6>
                      <input id="wkSalary" class="form-control" placeholder="e.g., Negotiable, 15k, 3m">
                      <div class="note mt-1">We’ll output as <b>Salary: $…</b> or <b>Salary: Negotiable.</b></div>
                    </div>
                  </div>

                  <div class="row g-3 mt-2">
                    <div class="col-12 col-md-6">
                      <h6>Construction site (optional)</h6>
                      <select id="wkSite" class="form-control">
                        <option value="">Not applicable</option>
                        <option>Construction site №1, Vespucci Boulevard</option>
                        <option>Construction site №2, Calais Avenue</option>
                        <option>Construction site №3, Pillbox Hill</option>
                      </select>
                    </div>
                  </div>

                  <div class="row g-3 mt-3">
                    <div class="col-12 d-flex gap-2">
                      <button class="btn bg-gradient-primary" onclick="generateWork()">Generate</button>
                      <button class="btn bg-gradient-secondary" onclick="clearForm('form-work')">Clear</button>
                    </div>
                  </div>
                </form>
              </div>
            </div>

            <!-- OUTPUT -->
            <div class="row mt-4">
              <div class="col-12">
                <h6>Formatted Output</h6>
                <div class="input-group input-group-outline my-2">
                  <input id="finalOutput" class="form-control" readonly placeholder="Your formatted ad will appear here…">
                  <button class="btn bg-gradient-primary" onclick="copyText()">Copy text</button>
                </div>
                <div id="checks" class="mt-2"></div>
                <div id="errors" class="mt-2"></div>
              </div>
            </div>

          </div>
        </div>
      </div>
    </section>
  </main>

  <footer class="footer py-4">
    <div class="container text-center small">
      Built for EN-03 policy accuracy — no formatting mistakes.
    </div>
  </footer>

  <!-- JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>

  <script>
    // ---------- Utilities ----------
    const $ = id => document.getElementById(id);
    const lc = s => (s||'').toLowerCase();
    const tcFirst = s => s ? s[0].toUpperCase() + s.slice(1) : s;

    const OFFICIAL_PLACES = ['Vinewood Hills','Rockford Hills','Richman','Sandy Shores','Paleto Bay','Postal','Hospital','Capitol','Fire Station','Auto Fair','Bahama Mamas Bar','Tequi-la-la Bar','FIB','Hotel Spa Bar','Pacific Bluffs Country Club','Diamond Resort Bar','Vanilla Unicorn Bar','Church','Stock Exchange','Stadium','Chumash','Lifeinvader','Del Perro Pier','Del Perro Beach','Cayo Perico Island','Hotel','Raton Canyon','School','SAHP'];
    const UNOFFICIAL_PLACES = ['airport','autosalon','beach','beach market','ghetto','post office','train station','yacht'];

    function fixPlaces(text){
      OFFICIAL_PLACES.forEach(p => text = text.replace(new RegExp(p.replace(/[()]/g,'\\$&'), 'ig'), p));
      UNOFFICIAL_PLACES.forEach(p => text = text.replace(new RegExp(`\\b${p}\\b`, 'ig'), p.toLowerCase()));
      return text;
    }

    const BLACKLIST = new Set([
      'firearm','firearms','gun','guns','weapon','weapons','pistol','rifle','shotgun','ammo','ammunition',
      'bulletproof vest','bulletproof vests','armor plates','armor plate','armor',
      'weed','cannabis','cannabis seeds','weed seeds','drug','drugs','cocaine',
      'ems surgical mask','surgical mask','medical mask','covid mask','ems mask',
      'vehicle scanner','human scanner','resource scanner','scanner','radar','anti-radar',
      'balaclava','balaclava mask','bandit mask',
      'rope','ropes','head bag','head bags',
      'usb with virus',
      'lock pick','lock picks','lockpick','lockpicks','crowbar','crowbars',
      'animal skin','satellite dish','barricade','engine block','air horn'
    ]);

    function containsBlacklist(str){
      const s = lc(str);
      for (const bad of BLACKLIST) if (s.includes(bad)) return bad;
      return null;
    }

    const dotThousands = n => String(Math.trunc(Math.abs(Number(n)))).replace(/\B(?=(\d{3})+(?!\d))/g, '.');

    function normalizeMoney(str){
      if (!str) return '';
      let t = ' ' + String(str).trim() + ' ';
      // normalize shorthands: k/M
      t = t.replace(/\$?\s*([\d.,]+)\s*([kKmM])\b/g, (_, num, suf) => {
        const val = parseFloat(String(num).replace(/,/g,'.'));
        if (!isFinite(val)) return `$${num}`;
        if (suf.toLowerCase()==='k') return `$${dotThousands(Math.round(val*1000))}`;
        return `$${val % 1 === 0 ? val.toFixed(0) : String(val)} Million`;
      });
      // plain numbers → $ with dot thousands (avoid ones already followed by "Million")
      t = t.replace(/\$?\s*(\d{1,3}(?:[,.]\d{3})+|\d+)(?!\s*Million)\b/g, (_, num) => {
        const clean = String(num).replace(/,/g,'');
        if (!/^\d+(\.\d+)?$/.test(clean)) return `$${num}`;
        return `$${dotThousands(clean)}`;
      });
      t = t.replace(/\bnegotiable\b/ig,'Negotiable');

      // trim
      t = t.trim();
      return t;
    }

    function addEndPeriod(s){
      s = s.trim();
      if (/\d$/.test(s) && !/\bMillion\.$/i.test(s)) return s; // numbers at end → no period
      if (!s.endsWith('.')) s += '.';
      return s;
    }

    function licenseOK(text){
      const m = /\blicense plate\s*\(([^)]+)\)/i.exec(text);
      if (!m) return true;
      const val = m[1].trim();
      return val.length>=3 && val.length<=7;
    }

    function setChecks(txt, opener){
      const box = $('checks'); box.innerHTML = '';
      const add = (msg, cls='') => box.insertAdjacentHTML('beforeend', `<span class="chip ${cls}">${msg}</span> `);
      /^[A-Z]/.test(txt) ? add('Capitalization ✓','ok') : add('Capitalization ✕','bad');
      if (opener==='Buying') /Budget:/.test(txt) ? add('Buyer→Budget ✓','ok') : add('Buyer→Budget ✕','bad');
      if (opener==='Selling' || opener==='Selling or trading') /Price:/.test(txt) ? add('Seller→Price ✓','ok') : add('Seller→Price ✕','bad');
      if (opener==='Renting out') /Rent:/.test(txt) ? add('Rent ✓','ok') : add('Rent ✕','bad');
      /(\.|\d)$/.test(txt.trim()) ? add('End punctuation ✓','ok') : add('End punctuation ✕','bad');
      if (!licenseOK(txt)) add('License plate len ✕','bad'); else if (/\blicense plate\b/i.test(txt)) add('License plate ✓','ok');
    }

    function setErrors(arr){
      const box = $('errors'); box.innerHTML = '';
      arr.forEach(e => box.insertAdjacentHTML('beforeend', `<div class="error-box">${e}</div>`));
    }

    function copyText(){
      const v = $('finalOutput').value.trim();
      if (!v) return;
      navigator.clipboard.writeText(v);
    }

    function clearFields(ids){
      ids.forEach(id => { const el=$(id); if(el) el.value='' });
      $('finalOutput').value='';
      $('checks').innerHTML='';
      $('errors').innerHTML='';
    }
    function clearForm(formId){
      const form = document.getElementById(formId);
      if (!form) return;
      form.reset();
      $('finalOutput').value='';
      $('checks').innerHTML='';
      $('errors').innerHTML='';
      // reset dynamic labels
      if (formId==='form-real') $('reMoneyLabel').textContent='Price';
      if (formId==='form-auto') $('auMoneyLabel').textContent='Price';
      if (formId==='form-biz') $('bzMoneyLabel').textContent='Price';
      if (formId==='form-other') $('otMoneyLabel').textContent='Price';
    }

    // ---------- Shared Money Label Switch ----------
    function moneyLabelFor(opener){
      if (opener==='Buying') return 'Budget';
      if (opener==='Renting out') return 'Rent';
      if (opener==='Trading') return ''; // optional
      return 'Price';
    }
    function getChecked(name){
      const el = document.querySelector(`input[name="${name}"]:checked`);
      return el ? el.value : null;
    }

    // ---------- Real Estate ----------
    function generateReal(){
      const errors = [];
      const opener = getChecked('reAction') || 'Selling';
      $('reMoneyLabel').textContent = moneyLabelFor(opener) || 'Price';

      // Blacklist
      const rawAll = [$('reLoc').value, $('reOther').value].join(' ');
      const bad = containsBlacklist(rawAll);
      if (bad) { setErrors([`Rejected: contains blacklisted term: ${bad}`]); $('finalOutput').value=''; return; }

      let type = $('reType').value; // house/apartment/penthouse/mansion
      let num = ($('reNum').value||'').trim();
      let loc = ($('reLoc').value||'').trim();

      // Build object
      let subject;
      if (num) subject = `${type} №${num}`;
      else subject = (/^[aeiou]/i.test(type)?'an ':'a ') + type;

      // Features in policy order
      const feats = [];
      if ($('reGarden').checked) feats.push('a garden');
      const gs = $('reGS').value; if (gs) feats.push(gs);
      const wh = ($('reWH').value||'').trim(); if (wh) feats.push(`${wh} w.h.`);
      if ($('reCustom').checked) feats.push('custom interior');
      if ($('reIns').checked) feats.push('insurance');
      if ($('reHeli').checked) feats.push('helipad');
      const others = ($('reOther').value||'').split(',').map(s=>s.trim()).filter(Boolean);
      feats.push(...others);

      if (feats.length){
        const tail = feats.length===1 ? feats[0] : feats.slice(0,-1).join(', ') + ' and ' + feats.slice(-1);
        subject += ` with ${tail}`;
      }
      if (loc) subject += ` in ${loc}`;

      subject = tcFirst(subject);
      subject = addEndPeriod(subject);

      // apartments cannot be insured
      if (/^Selling|Buying|Renting out/.test(opener)) {
        if (/apartment №\d+.*insurance/i.test(subject)) {
          errors.push('Apartments cannot be insured.');
        }
      }
      // houses/apartments/penthouse/mansion are not tradable
      if ((opener==='Trading' || opener==='Selling or trading') && /\b(house|apartment|penthouse|mansion)\b/i.test(subject)) {
        errors.push('Houses and apartments are not tradable.');
      }

      // Money line
      const label = moneyLabelFor(opener);
      let mraw = ($('reAmt').value||'').trim();
      let mline = '';
      if (label){
        if (!mraw || /negotiable/i.test(mraw)) mline = `${label}: Negotiable.`;
        else {
          const norm = normalizeMoney(mraw);
          const endNum = /\d$/.test(norm) && !/\bMillion\b/.test(norm);
          mline = `${label}: ${norm}${endNum?'':'.'}`;
        }
      } else if (mraw) {
        const norm = normalizeMoney(mraw);
        const endNum = /\d$/.test(norm) && !/\bMillion\b/.test(norm);
        mline = `Price: ${norm}${endNum?'':'.'}`;
      }

      // Fix places & Casino penthouse wording
      subject = subject.replace(/\bCasino apartment\b/ig,'Casino penthouse');
      subject = fixPlaces(subject);

      // Compose
      let out = `${opener} ${subject}`;
      out = out.replace(/\.\./g,'.'); // cleanup
      out = out.replace(/\s+\./g,'.');
      if (mline) out += ' ' + mline;

      // license plate check (real estate rarely has, but keep generic)
      if (!licenseOK(out)) errors.push('License plate must be 3–7 characters in length.');

      $('finalOutput').value = out;
      setChecks(out, opener);
      setErrors(errors);
    }

    // ---------- Auto ----------
    function generateAuto(){
      const errors = [];
      const opener = getChecked('auAction') || 'Selling';
      $('auMoneyLabel').textContent = moneyLabelFor(opener) || 'Price';

      // Blacklist (name field minimal check)
      const bad = containsBlacklist($('auName').value);
      if (bad) { setErrors([`Rejected: contains blacklisted term: ${bad}`]); $('finalOutput').value=''; return; }

      let name = ($('auName').value||'').trim();
      if (name && !/^".*"$/.test(name)) name = `"${name}"`;

      // Upgrades in order
      const bits = [];
      const cfg = $('auCfg').value;
      if (cfg) bits.push(cfg);
      if ($('auVisual').checked) bits.push('visual upgrades');
      if ($('auLumi').checked) bits.push('luminous wheels');
      if ($('auIns').checked) bits.push('insurance');
      if ($('auTurbo').checked) bits.push('turbo kit');
      if ($('auDrift').checked) bits.push('drift kit');

      let subject = name || 'a car';
      if (bits.length){
        subject += ' ' + (bits[0].startsWith('with') ? bits[0] : 'with ' + bits[0]) + (bits.slice(1).length ? ', ' + bits.slice(1).join(', ') : '');
      }
      subject = addEndPeriod(tcFirst(subject));

      // Money
      const label = moneyLabelFor(opener);
      let mraw = ($('auAmt').value||'').trim();
      let mline = '';
      if (label){
        if (!mraw || /negotiable/i.test(mraw)) mline = `${label}: Negotiable.`;
        else {
          const norm = normalizeMoney(mraw);
          const endNum = /\d$/.test(norm) && !/\bMillion\b/.test(norm);
          mline = `${label}: ${norm}${endNum?'':'.'}`;
        }
      } else if (mraw) {
        const norm = normalizeMoney(mraw);
        const endNum = /\d$/.test(norm) && !/\bMillion\b/.test(norm);
        mline = `Price: ${norm}${endNum?'':'.'}`;
      }

      // Compose
      let out = `${opener} ${subject}`;
      if (mline) out += ' ' + mline;

      if (!licenseOK(out)) errors.push('License plate must be 3–7 characters in length.');

      $('finalOutput').value = out;
      setChecks(out, opener);
      setErrors(errors);
    }

    // ---------- Other ----------
    function generateOther(){
      const errors = [];
      const opener = getChecked('otAction') || 'Selling';
      $('otMoneyLabel').textContent = moneyLabelFor(opener) || 'Price';

      const items = [ $('ot1').value, $('ot2').value, $('ot3').value ].map(s=>(s||'').trim()).filter(Boolean);
      if (items.length===0){ setErrors(['Please provide at least one item.']); $('finalOutput').value=''; return; }
      if (items.length>3) errors.push('Cannot advertise more than 3 items at a time.');

      // Blacklist across items
      const bad = containsBlacklist(items.join(' '));
      if (bad) { setErrors([`Rejected: contains blacklisted term: ${bad}`]); $('finalOutput').value=''; return; }

      let subject = opener + ' ';
      if (items.length===1) subject += items[0];
      else subject += items.join(', ').replace(/,([^,]*)$/, ' and$1');
      subject = addEndPeriod(tcFirst(subject));

      // Event addition
      const ev = ($('otEvent').value||'').trim();
      if (ev){
        if (ev.endsWith('№')) subject = subject.replace(/\.$/,'') + ' ' + ev + '0.'; // placeholder №
        else subject += ' ' + ev;
      }

      // Money
      const label = moneyLabelFor(opener);
      let mraw = ($('otAmt').value||'').trim();
      let mline = '';
      if (label){
        if (!mraw || /negotiable/i.test(mraw)) mline = `${label}: Negotiable.`;
        else {
          const norm = normalizeMoney(mraw);
          const endNum = /\d$/.test(norm) && !/\bMillion\b/.test(norm);
          mline = `${label}: ${norm}${endNum?'':'.'}`;
        }
      } else if (mraw){
        const norm = normalizeMoney(mraw);
        const endNum = /\d$/.test(norm) && !/\bMillion\b/.test(norm);
        mline = `Price: ${norm}${endNum?'':'.'}`;
      }

      // Beach market rule: if “at the beach market shop №”, remove “Negotiable.”
      if (/beach market shop №\d+/i.test(subject) && /Negotiable\.$/i.test(mline)) mline = '';

      let out = subject + (mline? (' ' + mline) : '');
      if (!licenseOK(out)) errors.push('License plate must be 3–7 characters in length.');

      $('finalOutput').value = out;
      setChecks(out, opener);
      setErrors(errors);
    }

    // ---------- Business ----------
    function generateBiz(){
      const errors = [];
      const opener = getChecked('bzAction') || 'Selling';
      $('bzMoneyLabel').textContent = moneyLabelFor(opener) || 'Price';

      // Blacklist
      const bad = containsBlacklist($('bzName').value);
      if (bad) { setErrors([`Rejected: contains blacklisted term: ${bad}`]); $('finalOutput').value=''; return; }

      const name = $('bzName').value;
      const num = ($('bzNum').value||'').trim();
      let subj = name + (num? ` №${num}` : ' business');
      subj = addEndPeriod(tcFirst(subj));

      // Money with >$300m => Negotiable
      let mraw = ($('bzAmt').value||'').trim();
      let label = moneyLabelFor(opener);
      if (label==='') label = 'Price';
      let mline = '';
      if (!mraw || /negotiable/i.test(mraw)) mline = `${label}: Negotiable.`;
      else {
        const norm = normalizeMoney(mraw);
        const over = /\$?(\d+)\s*Million/i.exec(norm);
        let finalNorm = norm;
        if (over && Number(over[1])>300) finalNorm = 'Negotiable';
        const endNum = /\d$/.test(finalNorm) && !/\bMillion\b/.test(finalNorm);
        mline = `${label}: ${finalNorm}${endNum?'':'.'}`;
      }

      let out = `${opener} ${subj} ${mline}`.trim();
      $('finalOutput').value = out;
      setChecks(out, opener);
      setErrors(errors);
    }

    // ---------- Dating ----------
    function generateDating(){
      const errors = [];
      let base = $('dtType').value; // allowed phrases or “Looking for Casino poker players.”
      let person = ($('dtName').value||'').trim();

      if (person){
        const m = /^([a-z]+)\s+([a-z]+)$/i.exec(person);
        if (!m){ errors.push('Please provide full first and last name (e.g., John Smith).'); }
        else {
          person = tcFirst(m[1].toLowerCase()) + ' ' + tcFirst(m[2].toLowerCase());
          base = `Looking for ${person}.`;
        }
      }
      // no Price/Budget allowed
      let out = base.trim();
      out = addEndPeriod(tcFirst(out));
      $('finalOutput').value = out;
      setChecks(out, 'Looking for'); // special case
      setErrors(errors);
    }

    // ---------- Work ----------
    function generateWork(){
      const errors = [];
      const type = getChecked('wkType') || 'Hiring';
      let role = ($('wkRole').value||'').trim();
      if (!role){ setErrors(['Please select a role.']); $('finalOutput').value=''; return; }
      let subj = type==='Hiring' ? `Hiring ${role}` : `${tcFirst(role)} looking for work`;
      const site = ($('wkSite').value||'').trim();
      if (site){
        subj += ` at ${site.replace(/,? (Vespucci Boulevard|Calais Avenue|Pillbox Hill)$/,'').trim()}, ${site.split(', ').slice(-1)[0]}`;
        // The select already includes proper phrasing; we won’t overprocess further.
      }
      subj = addEndPeriod(tcFirst(subj));

      let salary = ($('wkSalary').value||'').trim();
      let mline = '';
      if (salary){
        const norm = /negotiable/i.test(salary) ? 'Negotiable' : normalizeMoney(salary);
        const endNum = /\d$/.test(norm) && !/\bMillion\b/.test(norm);
        mline = `Salary: ${norm}${endNum?'':'.'}`;
      } else {
        mline = 'Salary: Negotiable.';
      }

      let out = `${subj} ${mline}`.trim();
      $('finalOutput').value = out;
      setChecks(out, type==='Hiring'?'Selling':'Buying'); // neutral mapping just for money chip colouring
      setErrors(errors);
    }

    // ---------- Dynamic money label switches ----------
    document.querySelectorAll('input[name="reAction"]').forEach(i=>i.addEventListener('change',()=>{ $('reMoneyLabel').textContent = moneyLabelFor(getChecked('reAction')) || 'Price'; }));
    document.querySelectorAll('input[name="auAction"]').forEach(i=>i.addEventListener('change',()=>{ $('auMoneyLabel').textContent = moneyLabelFor(getChecked('auAction')) || 'Price'; }));
    document.querySelectorAll('input[name="otAction"]').forEach(i=>i.addEventListener('change',()=>{ $('otMoneyLabel').textContent = moneyLabelFor(getChecked('otAction')) || 'Price'; }));
    document.querySelectorAll('input[name="bzAction"]').forEach(i=>i.addEventListener('change',()=>{ $('bzMoneyLabel').textContent = moneyLabelFor(getChecked('bzAction')) || 'Price'; }));

    // ---------- Demo defaults ----------
    // Real Estate sample: Selling house №85. Price: Negotiable.
    // Just click Generate on Real Estate with Number left empty or set to 85 to see both behaviours.
  </script>
</body>
</html>
